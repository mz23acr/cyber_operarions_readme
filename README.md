# 🛡️ Defense Automation Script: **Cyber Operation**

## 📄 **Purpose and Functionality**
This Bash script, `cyber_operation_script.sh`, automates defensive cybersecurity tasks, focusing on identifying, mitigating, and logging malicious activity in network traffic. It is designed to:
- 🔍 **Monitor Suspicious Traffic**: Logs all traffic involving compromised hosts.
- ✉️ **Analyze HTTP POST Requests**: Captures detailed packet data for potential exfiltration.
- 🔗 **Reassemble TCP Streams**: Provides deeper insights into malicious communication.
- 🚫 **Block Malicious IPs and Domains**: Prevents communication with attacker-controlled resources.
- ⚙️ **Apply Rate Limiting**: Mitigates brute force attacks on critical ports.
- 📊 **Monitor System Resources**: Detects anomalies in CPU and memory usage.

---

## 🛠️ **Instructions for Running the Script**
### **Step 1: Preparation**
1. Ensure you are running the script on a **Kali Linux VM** with the following tools pre-installed:
   - `tcpdump`
   - `iptables`
   - `dnsmasq`
   - `top`
2. Download the script and save it as `cyber_operation_script.sh`.

### **Step 2: Grant Execute Permissions**
Run the following command to make the script executable:
```bash
chmod +x cyber_operation_script.sh
```

### **Step 3: Execute the Script**
Run the script with superuser privileges:
```bash
sudo ./cyber_operation_script.sh
```

### **Step 4: Monitor Logs**
The script generates various logs for analysis. Use the following commands to monitor them in real-time:
- **Suspicious Traffic Logs**:
  ```bash
  tail -f /var/log/suspicious_traffic.log
  ```
- **HTTP POST Request Logs**:
  ```bash
  tail -f /var/log/post_requests.log
  ```
- **TCP Stream Reassembly Logs**:
  ```bash
  tail -f /var/log/tcp_stream_reassembly.log
  ```

---

## ⚙️ **Dependencies and Prerequisites**
1. **Environment**: The script requires a Kali Linux VM for execution.
2. **Root Access**: Ensure you have superuser privileges to execute commands like `iptables` and `tcpdump`.
3. **Tools**:
   - `tcpdump`: For capturing network traffic.
   - `iptables`: For blocking IPs and applying rate limits.
   - `dnsmasq`: For blocking malicious domains.
   - `top`: For monitoring system resource usage.

---

## 📊 **Sample Output**
The script generates the following outputs to demonstrate its effectiveness:

### 🛡️ **1. Blocking Malicious IPs**
- **Command**: 
  ```bash
  iptables -L
  ```
- **Description**: Displays all rules in the iptables, showing blocked IPs such as `5.252.178.193` and `94.131.101.186`.

---

### 🔍 **2. Suspicious Traffic Monitoring**
- **Command**:
  ```bash
  tail -f /var/log/suspicious_traffic.log
  ```
- **Description**: Real-time log showing suspicious traffic involving compromised hosts (e.g., `10.1.30.101`).

---

### ✉️ **3. HTTP POST Request Analysis**
- **Command**:
  ```bash
  tail -f /var/log/post_requests.log
  ```
- **Description**: Captures detailed packet data for HTTP POST requests, including headers and payloads.

---

### 🔗 **4. TCP Stream Reassembly**
- **Command**:
  ```bash
  tail -f /var/log/tcp_stream_reassembly.log
  ```
- **Description**: Reassembled TCP streams providing deeper insight into malicious communications.

---

### 📄 **5. Defense Report**
- **File Location**: `/var/log/defense_logs/defense_report.txt`
- **Description**: A summary report generated by the script, including blocked IPs, domain filters, rate limits, and log locations.

---

## ❌ **Stopping the Script**
To stop the script and terminate background logging processes:
1. Press `Ctrl+C` in the terminal where the script is running.
2. Alternatively, manually kill processes:
   ```bash
   kill $(jobs -p)
   ```

---

## 📁 **Log Files Overview**
- `suspicious_traffic.log`: Logs all suspicious traffic involving compromised hosts.
- `post_requests.log`: Captures HTTP POST request details.
- `tcp_stream_reassembly.log`: Logs reassembled TCP streams for analysis.
- `resource_monitor.log`: Monitors CPU and memory usage anomalies.
- `defense_report.txt`: Summarizes defensive actions taken by the script.

---
